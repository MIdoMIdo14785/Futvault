<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FUTVault — Price list</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{ --bg1:#071025; --bg2:#0b1020; --muted:#9aa4bf; --accent:#ffb020; --accent2:#0b74ff; }
  *{box-sizing:border-box}
  body{ margin:0; font-family:Inter,system-ui,Roboto,Arial; background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:#e6eef9; min-height:100vh; }
  .wrap{max-width:1100px;margin:28px auto;padding:18px;}
  header{display:flex;align-items:center;gap:14px;margin-bottom:12px}
  .logo{width:68px;height:68px;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center}
  .logo img{width:100%;height:100%;object-fit:cover}
  h1{margin:0;font-size:20px}
  .lead{color:var(--muted);font-size:13px;margin-top:4px}
  .controls{display:flex;gap:10px;margin:18px 0;align-items:center}
  .search{flex:1;padding:12px;border-radius:10px;border:0;background:rgba(255,255,255,0.03)}
  .select{padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}

  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px;margin-top:8px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;overflow:hidden;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:flex;flex-direction:column;position:relative}
  .cover-wrap{position:relative;overflow:hidden}
  .cover{width:100%;height:360px;object-fit:cover;display:block}
  .price-overlay{position:absolute;left:0;right:0;bottom:0;height:84px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;background:linear-gradient(180deg, rgba(2,6,23,0.0), rgba(2,6,23,0.45));}
  .price-left, .price-right{display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:40%}
  .price-text{background:linear-gradient(90deg,#ffd8a8,#ffb020);color:#081025;padding:8px 12px;border-radius:10px;font-weight:800}
  .price-text.secondary{background:rgba(255,255,255,0.06);color:var(--muted);font-weight:700}
  .card-body{padding:12px}
  .title{font-weight:800;font-size:15px;margin-bottom:6px}
  .meta{display:none} /* hide platform / sku as requested */
  .stock{color:var(--muted);font-size:13px}

  footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}

  @media (max-width:720px){
    .cover{height:220px}
    .price-overlay{flex-direction:column;height:auto;gap:8px;padding:10px}
    .price-left,.price-right{min-width:100%;flex-direction:row;gap:8px;justify-content:center}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><img src="assets/logo.png" alt="FUTVault logo" /></div>
      <div>
        <h1>FUTVault — Price list</h1>
        <div class="lead">Catalogue professionnel</div>
      </div>
    </header>

    <div class="controls">
      <input id="q" class="search" placeholder="Rechercher (titre, plateforme, SKU)..." />
      <select id="platform" class="select"><option value="">Toutes plateformes</option></select>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>
    <footer></footer>
  </div>

<script>
const DATA_URL='data/games.json';
let data=[];

async function fetchData(){
  try{
    const r=await fetch(DATA_URL,{cache:'no-store'});
    data=await r.json();
    render();
    populatePlatform();
  }catch(e){
    document.getElementById('grid').innerHTML='<div style="color:#ff6b6b">Erreur chargement data</div>';
  }
}
function populatePlatform(){
  const sel=document.getElementById('platform');
  const platforms=[...new Set(data.map(x=>x.platform||'').filter(Boolean))].sort();
  sel.innerHTML='<option value="">Toutes plateformes</option>'+platforms.map(p=>`<option value="${p}">${p}</option>`).join('');
}
function render(){
  const q=document.getElementById('q').value.trim().toLowerCase();
  const pf=document.getElementById('platform').value;
  const grid=document.getElementById('grid');
  const rows=data.filter(d=>{
    if(pf && (d.platform||'').toLowerCase()!==pf.toLowerCase()) return false;
    if(!q) return true;
    return ((d.title||'')+' '+(d.platform||'')+' '+(d.sku||'')+' '+(d.notes||'')).toLowerCase().includes(q);
  });
  if(!rows.length){ grid.innerHTML='<div style="color:var(--muted)">Aucun résultat</div>'; return; }
  grid.innerHTML=rows.map(r=>{
    const ps5Primary = r.prices?.ps5?.primary || r.price_primary || '';
    const ps5Secondary = r.prices?.ps5?.secondary || r.price_secondary || '';
    const ps4Primary = r.prices?.ps4?.primary || (r.platform==='PS4'? r.price_primary : '') || '';
    const img = r.image || 'assets/fc26.png';
    return `
      <div class="card">
        <div class="cover-wrap">
          <img class="cover" src="${img}" alt="${escapeHtml(r.title)}" loading="lazy" />
          <div class="price-overlay">
            <div class="price-left">
              <div style="font-size:12px;color:var(--muted)">PS5</div>
              <div class="price-text">${escapeHtml(ps5Primary || '—')}</div>
              <div class="price-text secondary" style="margin-top:6px">${escapeHtml(ps5Secondary || '—')}</div>
            </div>
            <div class="price-right">
              <div style="font-size:12px;color:var(--muted)">PS4</div>
              <div class="price-text">${escapeHtml(ps4Primary || '—')}</div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="title">${escapeHtml(r.title)}</div>
          <div class="stock">Stock: ${escapeHtml(String(r.stock||'—'))}</div>
        </div>
      </div>
    `;
  }).join('');
}
function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

document.getElementById('q').addEventListener('input',render);
document.getElementById('platform').addEventListener('change',render);

fetchData();
</script>
</body>
</html>
