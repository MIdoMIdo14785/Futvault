<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FUTVault — Price list</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{ --bg1:#071025; --bg2:#0b1020; --muted:#9aa4bf; --accent:#ffb020; --accent2:#0b74ff; }
  *{box-sizing:border-box}
  body{ margin:0; font-family:Inter,system-ui,Roboto,Arial; background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:#e6eef9; min-height:100vh; }
  .wrap{max-width:1100px;margin:28px auto;padding:18px;}
  header{display:flex;align-items:center;gap:14px;margin-bottom:12px}
  .logo{width:68px;height:68px;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center}
  .logo img{width:100%;height:100%;object-fit:cover}
  h1{margin:0;font-size:20px}
  .lead{color:var(--muted);font-size:13px;margin-top:4px}
  .controls{display:flex;gap:10px;margin:18px 0;align-items:center}
  .search{flex:1;padding:12px;border-radius:10px;border:0;background:rgba(255,255,255,0.03)}
  .select{padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}

  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px;margin-top:8px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;overflow:hidden;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:flex;flex-direction:column;position:relative}
  .cover{width:100%;height:360px;object-fit:cover;display:block;background:#0b1220}
  .prices-below{display:flex;justify-content:space-between;align-items:flex-end;padding:12px 12px 6px 12px;gap:12px}
  .price-col{width:48%;display:flex;flex-direction:column;align-items:center}
  .price-label{font-size:12px;color:var(--muted);margin-bottom:6px}
  .price-primary{background:linear-gradient(90deg,#ffd8a8,#ffb020);color:#081025;padding:8px 12px;border-radius:10px;font-weight:800}
  .price-secondary{background:rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:10px;font-weight:700;margin-top:8px}
  .card-body{padding:8px 12px 18px 12px}
  .title{font-weight:800;font-size:15px;margin-bottom:6px}
  .meta{display:none} /* hide platform/sku */
  footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}

  @media (max-width:720px){
    .cover{height:220px}
    .prices-below{flex-direction:column;align-items:stretch;gap:8px}
    .price-col{width:100%;flex-direction:row;justify-content:center;gap:10px}
    .price-label{display:none}
    .price-secondary{margin-top:0}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><img src="assets/logo.png" alt="FUTVault logo" /></div>
      <div>
        <h1>FUTVault — Price list</h1>
        <div class="lead">Catalogue professionnel</div>
      </div>
    </header>

    <div class="controls">
      <input id="q" class="search" placeholder="Rechercher (titre, plateforme, SKU)..." />
      <select id="platform" class="select"><option value="">Toutes plateformes</option></select>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>
    <footer></footer>
  </div>

<script>
const DATA_URL='data/games.json';
let data=[];

async function fetchData(){
  try{
    const r=await fetch(DATA_URL,{cache:'no-store'});
    data=await r.json();
    render();
    populatePlatform();
  }catch(e){
    document.getElementById('grid').innerHTML='<div style="color:#ff6b6b">Erreur chargement data</div>';
  }
}
function populatePlatform(){
  const sel=document.getElementById('platform');
  const platforms=[...new Set(data.map(x=>x.platform||'').filter(Boolean))].sort();
  sel.innerHTML='<option value="">Toutes plateformes</option>'+platforms.map(p=>`<option value="${p}">${p}</option>`).join('');
}
function render(){
  const q=document.getElementById('q').value.trim().toLowerCase();
  const pf=document.getElementById('platform').value;
  const grid=document.getElementById('grid');
  const rows=data.filter(d=>{
    if(pf && (d.platform||'').toLowerCase()!==pf.toLowerCase()) return false;
    if(!q) return true;
    return ((d.title||'')+' '+(d.platform||'')+' '+(d.sku||'')+' '+(d.notes||'')).toLowerCase().includes(q);
  });
  if(!rows.length){ grid.innerHTML='<div style="color:var(--muted)">Aucun résultat</div>'; return; }
  grid.innerHTML=rows.map(r=>{
    const ps5Pri = r.prices?.ps5?.primary || r.price_primary || '';
    const ps5Sec = r.prices?.ps5?.secondary || r.price_secondary || '';
    const ps4Pri = r.prices?.ps4?.primary || (r.platform==='PS4'? r.price_primary : '');
    const img = r.image || 'assets/fc26.png';
    return `
      <div class="card">
        <img class="cover" src="${img}" alt="${escapeHtml(r.title)}" loading="lazy" />
        <div class="prices-below">
          <div class="price-col">
            <div class="price-label">PS5</div>
            <div class="price-primary">${escapeHtml(ps5Pri || '—')} <div style="font-size:12px;color:var(--muted);margin-top:6px">Principal</div></div>
            <div class="price-secondary">${escapeHtml(ps5Sec || '—')} <div style="font-size:12px;color:var(--muted);margin-top:6px">Secondaire</div></div>
          </div>
          <div class="price-col">
            <div class="price-label">PS4</div>
            <div class="price-primary">${escapeHtml(ps4Pri || '—')}<div style="font-size:12px;color:var(--muted);margin-top:6px">Principal</div></div>
          </div>
        </div>
        <div class="card-body">
          <div class="title">${escapeHtml(r.title)}</div>
        </div>
      </div>
    `;
  }).join('');
}
function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

document.getElementById('q').addEventListener('input',render);
document.getElementById('platform').addEventListener('change',render);

fetchData();
</script>
</body>
</html>
